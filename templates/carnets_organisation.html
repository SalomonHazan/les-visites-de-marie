{% extends "base.html" %}

{% block content %}
<div class="carnets-organisation-container">
    <div class="carnets-organisation-header">
        <h1>{{ current_menu.page_title|default(current_menu.title) }}</h1>
        <p class="carnets-organisation-description">{{ current_menu.page_description|default(current_menu.description) }}</p>
    </div>

    <div class="carnets-organisation-grid">
        {% if categories_organisation and categories_organisation.carnet_organisation %}
            {% for category_id, category in categories_organisation.carnet_organisation.items() %}
                {% if category.active %}
                    <div class="carnet-organisation-card">
                        <div class="carnet-organisation-card-header">
                            <div class="carnet-organisation-icon">{{ category.icon }}</div>
                            <h3>{{ category.name }}</h3>
                        </div>
                        <p class="carnet-organisation-description">{{ category.description }}</p>
                        
                        {% if carnets_organisation and carnets_organisation[category_id] %}
                            <div class="carnet-organisation-items">
                                {% for carnet in carnets_organisation[category_id] %}
                                    <div class="carnet-organisation-item">
                                        <h4>{{ carnet.title }}</h4>
                                        <p>{{ carnet.description }}</p>
                                        <a href="{{ url_for('carnet_organisation_detail', category_id=category_id, slug=carnet.id) }}" class="btn btn-primary">
                                            Voir le carnet
                                        </a>
                                        
                                        {% if session.admin_logged_in %}
                                            <div class="carnet-admin-actions">
                                                <a href="{{ url_for('admin_edit_carnet_organisation_page', category_id=category_id, carnet_id=carnet.id) }}" class="btn btn-edit">Modifier</a>
                                                <a href="{{ url_for('admin_delete_carnet_organisation', category_id=category_id, carnet_id=carnet.id) }}" class="btn btn-delete" onclick="return confirm('Êtes-vous sûr de vouloir supprimer ce carnet ?')">Supprimer</a>
                                            </div>
                                        {% endif %}
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <p class="no-carnets">Aucun carnet disponible pour cette catégorie.</p>
                        {% endif %}
                        
                        {% if session.admin_logged_in %}
                            <div class="carnet-organisation-actions">
                                <a href="{{ url_for('admin_new_carnet_organisation_page', category_id=category_id) }}" class="btn btn-add-page">
                                    Ajouter un carnet
                                </a>
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        {% else %}
            <div class="no-categories">
                <p>Aucune catégorie d'organisation disponible.</p>
            </div>
        {% endif %}
    </div>
</div>

<style>
.carnets-organisation-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.carnets-organisation-header {
    text-align: center;
    margin-bottom: 40px;
}

.carnets-organisation-header h1 {
    color: #2c3e50;
    margin-bottom: 10px;
    font-size: 2.5em;
}

.carnets-organisation-description {
    color: #7f8c8d;
    font-size: 1.1em;
    line-height: 1.6;
}

.carnets-organisation-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 30px;
    margin-top: 30px;
}

.carnet-organisation-card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 2px solid #f8f9fa;
}

.carnet-organisation-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.carnet-organisation-card-header {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.carnet-organisation-icon {
    font-size: 2em;
    margin-right: 15px;
}

.carnet-organisation-card-header h3 {
    color: #2c3e50;
    margin: 0;
    font-size: 1.4em;
}

.carnet-organisation-description {
    color: #7f8c8d;
    line-height: 1.5;
    margin-bottom: 20px;
}

.carnet-organisation-items {
    margin-bottom: 20px;
}

.carnet-organisation-item {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
    border-left: 4px solid #3498db;
}

.carnet-organisation-item h4 {
    color: #2c3e50;
    margin: 0 0 8px 0;
    font-size: 1.1em;
}

.carnet-organisation-item p {
    color: #7f8c8d;
    margin: 0 0 12px 0;
    font-size: 0.9em;
}

.carnet-admin-actions {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.carnet-organisation-actions {
    text-align: center;
    margin-top: 20px;
}

.no-carnets, .no-categories {
    text-align: center;
    color: #7f8c8d;
    font-style: italic;
    padding: 20px;
}

.btn-add-page {
    background: #27ae60;
    color: white;
}

.btn-add-page:hover {
    background: #229954;
}

@media (max-width: 768px) {
    .carnets-organisation-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .carnet-organisation-card {
        padding: 20px;
    }
    
    .carnet-organisation-card-header h3 {
        font-size: 1.2em;
    }
}
</style>
{% endblock %}




